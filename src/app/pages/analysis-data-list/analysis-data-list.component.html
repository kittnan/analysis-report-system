<div class="loading" *ngIf="LoadingPage">
    <div class="spinner">

    </div>
</div>
<div class="col-12" style="background-color: white; padding: 40px; border-radius: 12px; box-shadow: 0 6px 10px -4px rgb(0 0 0 / 15%);">
    <div class="row">
        <div class="col-md-12 border-bottom" [formGroup]="Form">

            <div class="row">
                <div class="col-lg-12 text-right">
                    <button class="btn btn-sm text-primary" (click)="onClickExportExcel();">Export
            <i class="bi bi-file-earmark-spreadsheet"></i></button>
                    <button class="btn btn-sm  text-danger" style="text-align: right; cursor: pointer;" (click)="ResetConditionFilter()">Reset
            filters <i class="bi bi-bootstrap-reboot i-re"></i></button>

                </div>
            </div>
            <div class="row">
                <div class="col-lg-6 col-md-12 col-sm-12">
                    <div class="form-group">
                        <label>Model </label>
                        <div class="input-group mb-3">
                            <select class="custom-select" formControlName="ModelSelect" style="cursor: pointer;">
                <option [value]="null" disabled>--select--
                </option>
                <option *ngFor="let item of RequestItems" value="{{item._id}}">
                  {{item.name}}</option>
              </select>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-md-12 col-sm-12">
                    <div class="form-group">
                        <label>Month </label>
                        <input type="month" formControlName="Month" class="form-control" (blur)="handleEventDate('month')">
                    </div>
                    <!-- <div class="form-group">
                        <label>Month </label>
                        <div class="input-group mb-3">
                            <select class="custom-select" formControlName="Month" style="cursor: pointer;" (blur)="handleEventDate('month')">
                                <option [value]="null" disabled>--select--</option>
                                <option *ngFor="let item of RequestItems" value="{{item._id}}">
                                    {{item.name}}</option>
                            </select>
                        </div>
                    </div> -->
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12">
                    <div class="row">
                        <div class="col-lg-6 col-md-12 col-sm-12">
                            <div class="form-group">
                                <label>Issue Date Start
                </label>
                                <input type="date" formControlName="DateStart" class="form-control" (blur)="handleEventDate('day')">
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-12 col-sm-12">
                            <div class="form-group">
                                <label>Issue Date End
                </label>
                                <input type="date" formControlName="DateEnd" class="form-control" (blur)="handleEventDate('day')">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12">
                    <button class="btn btn-block" (click)="OnClickSearch()">Search <i class="bi bi-search"
              style="font-size: 1.5em;"></i></button>
                </div>
            </div>



            <div class="row mt-2" *ngIf="rowData.length !=0">
                <!-- <div class="col-12"> -->
                <div class="col-lg-6 col-md-12 col-sm-12">
                    <button class="btn btn-block" (click)="onSaveFilter()">
            save filter
          </button>
                </div>
                <div class="col-lg-6 col-md-12 col-sm-12">
                    <button class="btn btn-block" (click)="onClearFilter()">
            clear filter
          </button>
                </div>
                <!-- </div> -->
                <div class="col-lg-12 ag-grid-h">
                    <ag-grid-angular style="width: 100%; height: 100%;" (cellClicked)="onCellClicked($event)" style="width: 100%; height: 100%;" class="ag-theme-alpine" [rowData]="rowData" [columnDefs]="columnDefs" [defaultColDef]="defaultColDef" [pagination]="false" [paginationAutoPageSize]="true"
                        [animateRows]="true" (gridReady)="onGridReady($event)">
                    </ag-grid-angular>
                </div>
            </div>

            <div class="row" *ngIf="gridApi">
                <div class="col-12 text-right">

                    <span>
            Rows: {{showCountRows()}}
          </span>
                </div>
            </div>


        </div>
    </div>
</div>